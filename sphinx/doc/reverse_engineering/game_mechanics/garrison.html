

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Garrison &mdash; openage v0.4.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
          

          
            <a href="../../../index.html" class="icon icon-home"> openage
          

          
            
            <img src="../../../_static/banner.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../sphinx/installation/index.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../sphinx/installation/basic_installation.html">Basic Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../sphinx/installation/basic_installation.html#linux-installation">Linux Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../sphinx/installation/basic_installation.html#windows-installation">Windows Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../sphinx/installation/basic_installation.html#macos-installation">macOS Installation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../sphinx/installation/building.html">Building from Source</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../building.html">Building the project</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../build_instructions/index.html">Dependency installation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../sphinx/installation/platform_support.html">Platform Support</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../sphinx/installation/platform_support.html#continuous-integration-targets">Continuous Integration Targets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../sphinx/installation/platform_support.html#other-platforms">Other Platforms</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../troubleshooting.html">Troubleshooting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../troubleshooting.html#windows-installer">Windows Installer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../troubleshooting.html#asset-conversion">Asset Conversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../troubleshooting.html#ingame">Ingame</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../sphinx/handbooks/index.html">Handbooks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../sphinx/handbooks/handbook-user/index.html">User handbook</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../sphinx/handbooks/handbook-user/overview.html">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../sphinx/handbooks/handbook-user/tutorial.html">Tutorials</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../sphinx/handbooks/handbook-mod/index.html">Modding handbook</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../sphinx/handbooks/handbook-mod/overview.html">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../sphinx/handbooks/handbook-mod/concepts.html">Concepts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../sphinx/handbooks/assets_conversion.html">Assets &amp; Conversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../nyan/index.html">nyan - Entity-Component-System</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../sphinx/handbooks/reverse_engineering.html">Reverse Engineering</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ideas/index.html">Ideas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../sphinx/handbooks/handbook-mod/tutorial.html">Tutorials</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../sphinx/handbooks/handbook-dev/index.html">Developing handbook</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../sphinx/handbooks/handbook-dev/overview.html">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../sphinx/handbooks/handbook-dev/concepts.html">Concepts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../sphinx/handbooks/handbook-dev/code_style.html">Code-style</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../code/index.html">Code documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../nyan/index.html">nyan - Entity-Component-System</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../sphinx/handbooks/assets_conversion.html">Assets &amp; Conversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../sphinx/handbooks/reverse_engineering.html">Reverse Engineering</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ideas/index.html">Ideas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../sphinx/handbooks/handbook-dev/tutorial.html">Tutorials</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../sphinx/reference/index.html">References</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../nyan/api_reference/index.html">API reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../nyan/api_reference/reference_ability.html">engine.ability</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../nyan/api_reference/reference_aux.html">engine.aux</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../nyan/api_reference/reference_effect.html">engine.effect</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../nyan/api_reference/reference_modifier.html">engine.modifier</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../nyan/api_reference/reference_resistance.html">engine.resistance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../nyan/api_reference/reference_root.html">engine.root</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../sphinx/reference/doxygen.html">openage c++/python reference</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../sphinx/whatsnew.html">What’s new?</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../sphinx/changelogs.html">Changelogs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../changelog.html">Changelog</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelogs/engine/index.html">Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelogs/nyan_api/index.html">Nyan API</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../sphinx/releasenotes.html">Release Notes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../releasenotes.html">0.4.0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../releasenotes.html#id2">0.3.0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../releasenotes.html#id5">0.2.3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../releasenotes.html#id8">0.2.2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../releasenotes.html#id11">0.2.1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../releasenotes.html#id14">0.2.0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../releasenotes.html#id17">0.1.0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../releasenotes.html#id20">0.0.0</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../sphinx/about.html">About</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../README.html">openage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../README.html#contact">Contact</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../README.html#technical-foundation">Technical foundation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../README.html#goals">Goals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../README.html#current-state-of-the-project">Current State of the Project</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../README.html#installation-packages">Installation Packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../README.html#dependencies-building-and-running">Dependencies, Building and Running</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../README.html#contributing">Contributing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../README.html#development-process">Development Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../README.html#license">License</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../README.html">Documentation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../README.html#static-docs">Static Docs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../README.html#dynamic-docs">Dynamic Docs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../status.html">openage status</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../status.html#the-list-must-grow">The list must grow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../status.html#working-features">Working features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../status.html#missing-functionality">Missing functionality</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../status.html#under-the-hood">Under the hood</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../milestones.html">Milestones</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">openage</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
      <li>Garrison</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/doc/reverse_engineering/game_mechanics/garrison.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="garrison">
<h1>Garrison<a class="headerlink" href="#garrison" title="Permalink to this headline">¶</a></h1>
<p>Mechanics related to garrisoning units in buildings or siege units.</p>
<div class="section" id="number-of-projectiles">
<h2>Number of projectiles<a class="headerlink" href="#number-of-projectiles" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://www.youtube.com/watch?v=tCBlWAkanPY">Source</a></p>
<p>How many projectiles a building fires depends on two variables, the <em>damage per second</em> value of the building and the (pierce) <em>damage per second</em> of each garrisoned unit. The amount of arrows added by a unit can be derived from this formula:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">additional_arrows</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">unit_dps_pierce</span><span class="p">)</span> <span class="o">/</span> <span class="n">building_dps</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">unit_dps_pierce</span></code> is calculated by dividing a unit’s pierce attack value by its reload speed. <code class="docutils literal notranslate"><span class="pre">building_dps</span></code> is obtained in the same way, by dividing the building’s attack value by its reload speed. Units doing melee damage do not increase the number of arrows or projectiles. However, for villagers <code class="docutils literal notranslate"><span class="pre">unit_dps_pierce</span></code> is a fixed value of <code class="docutils literal notranslate"><span class="pre">2.5</span></code>. Researching the Teuton unique technology <em>Crenellations</em> has a similar effect by setting <code class="docutils literal notranslate"><span class="pre">unit_dps_pierce</span></code> to <code class="docutils literal notranslate"><span class="pre">2.5</span></code> for every unit in the infantry armor class.</p>
<p>Bombard towers have even stricter rules in that only gunpowder units can increase the projectile count. The calculation of <code class="docutils literal notranslate"><span class="pre">building_dps</span></code> is also done slightly different. For the first additional projectile <code class="docutils literal notranslate"><span class="pre">sum(unit_dps_pierce)</span></code> is divided by <code class="docutils literal notranslate"><span class="pre">(building_dps</span> <span class="pre">*</span> <span class="pre">2)</span></code> which effectively doubles the amount of required units for an additional shot. For the second and third cannon ball the standard formula is used again.</p>
<p><strong>Pseudocode</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">remaining_unit_dps</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">unit_dps_pierce</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">building_dps</span> <span class="o">*</span> <span class="mi">2</span><span class="p">);</span>

    <span class="k">if</span><span class="p">(</span><span class="n">remaining_unit_dps</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">additional_arrows</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">remaining_unit_dps</span> <span class="o">/</span> <span class="n">building_dps</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="n">additional_arrows</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
</pre></div>
</div>
<p>The result <code class="docutils literal notranslate"><span class="pre">additional_arrows</span></code> is floored and added to the default arrow count of the building. A table with the default projectile counts is shown below.</p>
<table border="1" class="docutils">
<thead>
<tr>
<th>Building</th>
<th>Default Arrow Count</th>
<th>Default Attack</th>
<th>Maximum Arrow Count</th>
</tr>
</thead>
<tbody>
<tr>
<td>Town Center</td>
<td>0</td>
<td>5</td>
<td>10</td>
</tr>
<tr>
<td>Castle</td>
<td>5</td>
<td>11</td>
<td>20</td>
</tr>
<tr>
<td>Tower</td>
<td>1</td>
<td>5/7/8*</td>
<td>5</td>
</tr>
<tr>
<td>Bombard Tower</td>
<td>1</td>
<td>120**</td>
<td>4</td>
</tr>
</tbody>
</table><p>* Damage of Watch Tower/Guard Tower/Keep</p>
<p>** Calculation is different; see pseudocode above</p>
<p>Increasing the default attack damage of buildings by researching technologies also affects <code class="docutils literal notranslate"><span class="pre">building_dps</span></code>.</p>
<div class="section" id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<p>The Elite Janissary has a pierce attack value of <code class="docutils literal notranslate"><span class="pre">22</span></code> and a reload speed of <code class="docutils literal notranslate"><span class="pre">3.45</span></code> (The Conqueror’s). With these values we can calculate <code class="docutils literal notranslate"><span class="pre">unit_dps_pierce</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">unit_dps_pierce</span> <span class="o">=</span> <span class="mi">22</span> <span class="o">/</span> <span class="mf">3.45</span> <span class="o">=</span> <span class="mf">6.37</span>
</pre></div>
</div>
<p>Now that we know <code class="docutils literal notranslate"><span class="pre">unit_dps_pierce</span></code>, the amount of additional projectiles for each building can be obtained.</p>
<p><strong>Town Center</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">building_dps</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">/</span> <span class="mf">2.03</span> <span class="o">=</span> <span class="mf">2.46</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">additional_arrows</span> <span class="o">=</span> <span class="mf">6.37</span> <span class="o">/</span> <span class="mf">2.46</span> <span class="o">=</span> <span class="mf">2.58</span>
</pre></div>
</div>
<p><strong>Castle</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">building_dps</span> <span class="o">=</span> <span class="mi">11</span> <span class="o">/</span> <span class="mf">2.03</span> <span class="o">=</span> <span class="mf">5.41</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">additional_arrows</span> <span class="o">=</span> <span class="mf">6.37</span> <span class="o">/</span> <span class="mf">5.41</span> <span class="o">=</span> <span class="mf">1.17</span>
</pre></div>
</div>
<p><strong>Keep</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">building_dps</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">/</span> <span class="mf">2.03</span> <span class="o">=</span> <span class="mf">3.94</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">additional_arrows</span> <span class="o">=</span> <span class="mf">6.37</span> <span class="o">/</span> <span class="mf">3.94</span> <span class="o">=</span> <span class="mf">1.61</span>
</pre></div>
</div>
<p><strong>Bombard Tower</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">1</span><span class="n">st</span> <span class="n">additional</span> <span class="n">projectile</span><span class="p">)</span>
    <span class="n">building_dps</span> <span class="o">=</span> <span class="p">(</span><span class="mi">120</span> <span class="o">/</span> <span class="mi">6</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">=</span> <span class="mi">40</span>
<span class="p">(</span><span class="n">Other</span> <span class="n">additional</span> <span class="n">projectile</span><span class="p">)</span>
    <span class="n">building_dps</span> <span class="o">=</span> <span class="p">(</span><span class="mi">120</span> <span class="o">/</span> <span class="mi">6</span><span class="p">)</span>     <span class="o">=</span> <span class="mi">20</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">1</span><span class="n">st</span> <span class="n">additional</span> <span class="n">projectile</span><span class="p">)</span>
    <span class="n">additional_arrows</span> <span class="o">=</span> <span class="mf">6.37</span> <span class="o">/</span> <span class="mi">40</span> <span class="o">=</span> <span class="mf">0.155</span>
<span class="p">(</span><span class="n">Other</span> <span class="n">additional</span> <span class="n">projectile</span><span class="p">)</span>
    <span class="n">additional_arrows</span> <span class="o">=</span> <span class="mf">6.37</span> <span class="o">/</span> <span class="mi">20</span> <span class="o">=</span> <span class="mf">0.31</span>
</pre></div>
</div>
<p>7 Elite Janissaries are needed to make the bombard tower fire one additional projectile. Two additional cannon balls are only achievable with 10 Elite Janissaries garrisoned in a bombard tower.</p>
</div>
</div>
</div>
<div class="section" id="weird-aoe2-quirks">
<h1>Weird AoE2 Quirks<a class="headerlink" href="#weird-aoe2-quirks" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>Only units that do pierce damage can increase the number of projectiles fired by a building. Units that fire projectiles dealing melee damage - like Gbetos, Throwing Axemen and Mamelukes - will have no effect on the arrow count.</p></li>
<li><p>For the Cho Ko Nu <code class="docutils literal notranslate"><span class="pre">unit_dps_pierce</span></code> does not use the pierce attack value of the first arrow fired. Instead it only takes the damage the last arrow does into consideration. Because this arrow only does 3 pierce damage, the number of projectiles added to a building’s attack is fairly low.</p></li>
</ul>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2013-2019 openage-Team

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>